# Оптимизация буферной зоны склада
## WMS Buffer Management System

---

# Слайд 1: Текущая ситуация

## Звено "Хранение → Буфер → Сборка"

```
┌─────────────┐      ┌─────────────┐      ┌─────────────┐
│   ХРАНЕНИЕ  │ ──── │   БУФЕР     │ ──── │   СБОРКА    │
│             │  3   │  64 ячейки  │  20  │             │
│  Палеты     │ ───► │  Зона "I"   │ ───► │  Заказы     │
└─────────────┘      └─────────────┘      └─────────────┘
               карщика              сборщика
```

**Участники процесса:**
- **3 карщика** — доставляют моно-палеты из хранения в буфер
- **64 ячейки буфера** — временное хранение для сборки
- **20 сборщиков** — забирают товары и распределяют по заказам

**Проблема:** Как синхронизировать подачу палет со скоростью сборки?

---

# Слайд 2: Почему это важно

## Потери при неоптимальной работе

| Ситуация | Последствия |
|----------|-------------|
| **Буфер пустой** | Сборщики простаивают, заказы задерживаются |
| **Буфер переполнен** | Карщики ждут освобождения ячеек |
| **Неравномерная нагрузка** | Одни перегружены, другие простаивают |

## Цена простоя

- 20 сборщиков × 10 мин простоя = **3.3 человеко-часа потерь**
- При заполнении буфера < 15% — критическая ситуация
- Каждый сбой в потоке = задержка волны заказов

---

# Слайд 3: Наше решение — 3 уровня оптимизации

```
┌────────────────────────────────────────────────────────┐
│  УРОВЕНЬ 3: ПРОГНОЗИРОВАНИЕ (Historical)              │
│  ML-модели предсказывают время выполнения задач       │
├────────────────────────────────────────────────────────┤
│  УРОВЕНЬ 2: ПЛАНИРОВАНИЕ (Tactical)                   │
│  OR-Tools оптимизирует назначения и расписание        │
├────────────────────────────────────────────────────────┤
│  УРОВЕНЬ 1: РЕАГИРОВАНИЕ (Realtime)                   │
│  Гистерезис-контроллер управляет уровнем буфера       │
└────────────────────────────────────────────────────────┘
```

**Принцип:** Прогноз → План → Исполнение → Корректировка

---

# Слайд 4: ML-модели для прогнозирования

## Две модели на основе 1.5 млн исторических записей

### Модель 1: Время сборки (Picker Duration)

**Входные данные:**
- ID сборщика (личная скорость)
- Количество строк в задании
- Общее количество товаров
- Час дня, день недели

**Выход:** Прогноз времени выполнения задания (секунды)

### Модель 2: Время маршрута карщика (Forklift Duration)

**Входные данные:**
- ID карщика
- Зона источника → Зона назначения
- Вес палеты

**Выход:** Прогноз времени доставки (секунды)

---

# Слайд 5: Оптимизация расписания (OR-Tools)

## Задача: Минимизация общего времени выполнения

```
Дано:
  - N заданий на сборку (с прогнозом времени)
  - M палет для доставки (с прогнозом времени)
  - 3 карщика, 20 сборщиков
  - 64 ячейки буфера

Найти:
  - Какой карщик везёт какую палету?
  - В какую ячейку?
  - В каком порядке?

Критерий: Минимум общего времени (makespan)
```

**Дополнительные ограничения:**
- Тяжёлые палеты — в нижние ячейки
- Приоритетные заказы — в первую очередь
- Балансировка нагрузки между работниками

---

# Слайд 6: Как это работает вместе

```
┌─────────────────────────────────────────────────────────────┐
│                    ЦИКЛ ОПТИМИЗАЦИИ                         │
│                                                             │
│  ┌─────────┐    ┌─────────┐    ┌─────────┐    ┌─────────┐  │
│  │ Заказы  │───►│ Прогноз │───►│ OR-Tools│───►│Исполнен.│  │
│  │ (волна) │    │ ML.NET  │    │ CP-SAT  │    │  WMS    │  │
│  └─────────┘    └─────────┘    └─────────┘    └─────────┘  │
│       │                                            │        │
│       └────────────── Обратная связь ◄─────────────┘        │
│                  (корректировка моделей)                    │
└─────────────────────────────────────────────────────────────┘
```

**Каждые 15 минут (волна):**
1. Получаем список заказов для сборки
2. ML предсказывает время каждой операции
3. OR-Tools строит оптимальный план
4. План отправляется в WMS для исполнения
5. Результаты используются для улучшения моделей

---

# Слайд 7: Пример оптимизации

## Сценарий: Волна из 50 заданий

### БЕЗ оптимизации (текущее состояние)
```
Карщик 1: ████████████████████████  (перегружен)
Карщик 2: ████████░░░░░░░░░░░░░░░░  (недогружен)
Карщик 3: ██████████████░░░░░░░░░░  (средне)

Общее время волны: 45 минут
Простои сборщиков: 12%
```

### С оптимизацией (OR-Tools)
```
Карщик 1: ████████████████░░░░░░░░  (сбалансировано)
Карщик 2: ███████████████░░░░░░░░░  (сбалансировано)
Карщик 3: ████████████████░░░░░░░░  (сбалансировано)

Общее время волны: 32 минуты (-29%)
Простои сборщиков: 3%
```

---

# Слайд 8: Ожидаемые результаты

## Количественные улучшения

| Метрика | До | После | Улучшение |
|---------|-----|-------|-----------|
| Время волны | 45 мин | 32 мин | **-29%** |
| Простои сборщиков | 12% | 3% | **-75%** |
| Критические ситуации | 5/день | <1/день | **-80%** |
| Пробег карщиков | 100% | 85% | **-15%** |

## Качественные улучшения

- Предсказуемость времени выполнения заказов
- Автоматическая адаптация к изменениям (новые сборщики, сезонность)
- Данные для принятия управленческих решений

---

# Слайд 9: Технологический стек

## Используемые технологии

| Компонент | Технология | Назначение |
|-----------|------------|------------|
| **Runtime** | .NET 8 | Основа системы |
| **ML** | ML.NET FastTree | Прогнозирование времени |
| **Оптимизация** | Google OR-Tools CP-SAT | Планирование расписания |
| **База данных** | TimescaleDB | Хранение истории |
| **Интеграция** | REST API | Связь с WMS 1C |

## Данные для обучения

- **1.5 млн** исторических записей задач
- **64** ячейки буферной зоны
- Данные за последние **3+ месяца**

---

# Слайд 10: План внедрения

## Этапы

| Этап | Задачи | Результат |
|------|--------|-----------|
| **1. ML-модели** | Обучение на исторических данных | Прогноз времени операций |
| **2. Тестирование** | Сравнение прогнозов с реальностью | Оценка точности моделей |
| **3. OR-Tools** | Интеграция оптимизатора | Автоматическое планирование |
| **4. Пилот** | Работа на реальных данных | Валидация результатов |
| **5. Продакшн** | Полная интеграция с WMS | Автономная работа |

## Следующий шаг

**Запуск обучения ML-моделей** на загруженных данных и сравнение с простыми средними значениями.

---

# Контакты и вопросы

## Резюме

Система **WMS Buffer Management** позволит:
- Прогнозировать время выполнения операций
- Автоматически строить оптимальные планы
- Сократить время волны на **~30%**
- Минимизировать простои персонала

**Основа:** 1.5 млн исторических записей + ML.NET + OR-Tools

---
